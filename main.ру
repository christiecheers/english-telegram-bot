import telebot
from telebot import types
import time
import os
from flask import Flask
from threading import Thread

# Flask app –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
app = Flask('')

@app.route('/')
def home():
    return "Bot is running!"

def run_flask():
    app.run(host='0.0.0.0', port=8080)

def keep_alive():
    t = Thread(target=run_flask)
    t.daemon = True
    t.start()

API_TOKEN = os.environ['BOT_TOKEN']

bot = telebot.TeleBot(API_TOKEN)
user_data = {}

questions = [
    {
        'question': '–ß—Ç–æ –∑–Ω–∞—á–∏—Ç "pitch" –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–π —Ä–µ—á–∏?',
        'options': ['–ë—Ä–æ—Å–∞—Ç—å –º—è—á', '–ñ–∞–ª–æ–≤–∞—Ç—å—Å—è', '–í—ã–±—Ä–∞—Å—ã–≤–∞—Ç—å —á—Ç–æ-—Ç–æ 
–Ω–µ–Ω—É–∂–Ω–æ–µ'],
        'correct_answer': 2
    },
    {
        'question': '–ö–∞–∫–∞—è —Ñ—Ä–∞–∑–∞ –∑–≤—É—á–∏—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å 
–ø—Ä–æ—Ç–µ—Ä–µ—Ç—å —Å—Ç–æ–ª?',
        'options': ['I removed streaks from the table.', 'I wiped the 
table clean.', 'I cleaned up streaks.'],
        'correct_answer': 1
    },
    {
        'question': '–í—ã–±–µ—Ä–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ —É–±–æ—Ä–∫–∏:',
        'options': ['Everything is sparkling!', 'Everything shines like a 
diamond!', 'Everything is bright.'],
        'correct_answer': 0
    },
    {
        'question': '–ß—Ç–æ –∑–Ω–∞—á–∏—Ç "get moldy"?',
        'options': ['–ù–∞–º–æ–∫–Ω—É—Ç—å', '–ü–æ–∫—Ä—ã—Ç—å—Å—è –ø–ª–µ—Å–µ–Ω—å—é', '–ü—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å—Å—è –≤ 
–∫—Ä–æ—à–∫–∏'],
        'correct_answer': 1
    },
    {
        'question': '–ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å, –µ—Å–ª–∏ —Å–æ–∂–≥–ª–∞ –≤–æ–ª–æ—Å—ã –ø–ª–æ–π–∫–æ–π?',
        'options': ['I singed my hair with a curling iron.', 'I burned my 
hair with a hair straightener.', 'I fried my hair.'],
        'correct_answer': 0
    },
    {
        'question': '–ß—Ç–æ —Å–∫–∞–∑–∞—Ç—å, –µ—Å–ª–∏ –Ω–æ–≥–æ—Ç—å —Å–ª–µ–≥–∫–∞ –æ—Ç–∫–æ–ª–æ–ª—Å—è?',
        'options': ['My nail broke.', 'My nail fell.', 'My nail 
chipped.'],
        'correct_answer': 2
    },
    {
        'question': '–í—ã–±–µ—Ä–∏ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ:',
        'options': ['My hair is frizzy today.', 'My hair is electric 
today.', 'My hair is wild today.'],
        'correct_answer': 0
    },
    {
        'question': '–ß—Ç–æ –∑–Ω–∞—á–∏—Ç "razor burn"?',
        'options': ['–û–∂–æ–≥ –æ—Ç —Å–æ–ª–Ω—Ü–∞', '–†–∞–∑–¥—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç –±—Ä–∏—Ç–≤—ã', '–°–ª–µ–¥ –æ—Ç 
—É—Ç—é–≥–∞'],
        'correct_answer': 1
    },
    {
        'question': '–í—ã–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ:',
        'options': ['I soaked a stain before washing.', 'I dipped a stain 
before washing.', 'I wet a stain before washing.'],
        'correct_answer': 0
    },
    {
        'question': '–ß—Ç–æ –∑–Ω–∞—á–∏—Ç "hangnail"?',
        'options': ['–ë—ã—Å—Ç—Ä—ã–π —Ä–æ—Å—Ç –Ω–æ–≥—Ç—è', '–ó–∞—É—Å–µ–Ω–∏—Ü–∞', '–ì—Ä–∏–±–æ–∫ –Ω–æ–≥—Ç—è'],
        'correct_answer': 1
    }
]

@bot.message_handler(commands=['start'])
def send_welcome(message):
    user_data[message.chat.id] = {
        'current_question': 0,
        'score': 0,
        'answers': []
    }

    welcome_text = """
üéì *–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ English Test Bot!* üéì

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üëã *–ü—Ä–∏–≤–µ—Ç! –ú–µ–Ω—è –∑–æ–≤—É—Ç –ö—Ä–∏—Å—Ç–∏–Ω–∞*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

–Ø —Ä–µ–ø–µ—Ç–∏—Ç–æ—Ä –ø–æ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º—É –∏ –∞–≤—Ç–æ—Ä –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–∞–Ω–∞–ª–æ–≤, –≥–¥–µ –ø–æ–º–æ–≥–∞—é –ª—é–¥—è–º 
—É–≤–µ—Ä–µ–Ω–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç—å –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º –≤ –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö

üìä *–•–æ—á–µ—à—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ —Ç—ã –∑–Ω–∞–µ—à—å –±—ã—Ç–æ–≤—É—é –ª–µ–∫—Å–∏–∫—É?*

‚úÖ –ü—Ä–æ–π–¥–∏ –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ—Å—Ç –∏–∑ 10 –≤–æ–ø—Ä–æ—Å–æ–≤
‚è± –≠—Ç–æ –∑–∞–π–º—ë—Ç –º–µ–Ω—å—à–µ 2 –º–∏–Ω—É—Ç!
üéØ –£–∑–Ω–∞–π —Å–≤–æ–π —Ä–µ–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å

*–ü—Ä–æ–≤–µ—Ä—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å–≤–æ–±–æ–¥–Ω–æ —Ç—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ—à—å—Å—è –≤ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º –¥–ª—è:*
üè† –î–æ–º–∞—à–Ω–∏—Ö –¥–µ–ª –∏ —É–±–æ—Ä–∫–∏
üíÖ –£—Ö–æ–¥–∞ –∑–∞ —Å–æ–±–æ–π –∏ –≥–∏–≥–∏–µ–Ω—ã
üçΩ –ü–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏–π
üõí –ë—ã—Ç–æ–≤—ã—Ö –º–æ–º–µ–Ω—Ç–æ–≤

*–ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è —Ç–µ—Å—Ç–∞ —Ç—ã –ø–æ–ª—É—á–∏—à—å –ú–ò–ù–ò –£–†–û–ö –í –ü–û–î–ê–†–û–ö –ø–æ –±—ã—Ç—É!*

üëá *–ñ–º–∏ "–ù–ê–ß–ê–¢–¨ –¢–ï–°–¢" –∏ —É–∑–Ω–∞–π, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–≤–æ–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –ø—Ä–∏–±–ª–∏–∂–µ–Ω –∫ 
—Ä–µ–∞–ª—å–Ω–æ–π –∂–∏–∑–Ω–∏!*
    """

    markup = types.InlineKeyboardMarkup()
    start_test_button = types.InlineKeyboardButton('üöÄ –ù–ê–ß–ê–¢–¨ –¢–ï–°–¢', 
callback_data='start_test')
    markup.add(start_test_button)

    bot.send_message(
        message.chat.id,
        welcome_text,
        reply_markup=markup,
        parse_mode='Markdown'
    )

@bot.callback_query_handler(func=lambda call: call.data == 'start_test')
def start_test(call):
    chat_id = call.message.chat.id

    if chat_id not in user_data:
        user_data[chat_id] = {
            'current_question': 0,
            'score': 0,
            'answers': []
        }

    send_question(chat_id)

def send_question(chat_id):
    if chat_id not in user_data:
        bot.send_message(chat_id, "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞—á–Ω–∏—Ç–µ –∑–∞–Ω–æ–≤–æ —Å –∫–æ–º–∞–Ω–¥—ã 
/start")
        return

    user_state = user_data[chat_id]
    current_question = user_state['current_question']

    if current_question < len(questions):
        question_data = questions[current_question]

        markup = types.InlineKeyboardMarkup()

        for i, option in enumerate(question_data['options']):
            emoji = ['üü°', 'üîµ', 'üü¢'][i]
            button = types.InlineKeyboardButton(
                f"{emoji} {option}",
                callback_data=f'answer_{current_question}_{i}'
            )
            markup.add(button)

        question_text = f"""
üìù *–í–æ–ø—Ä–æ—Å {current_question + 1}/{len(questions)}*

{question_data['question']}

üëá *–í—ã–±–µ—Ä–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:*
        """

        msg = bot.send_message(
            chat_id,
            question_text,
            reply_markup=markup,
            parse_mode='Markdown'
        )

        user_state['last_message_id'] = msg.message_id

    else:
        show_results(chat_id)

@bot.callback_query_handler(func=lambda call: 
call.data.startswith('answer_'))
def handle_answer(call):
    chat_id = call.message.chat.id

    if chat_id not in user_data:
        bot.answer_callback_query(call.id, "‚ùå –ù–∞—á–Ω–∏—Ç–µ —Ç–µ—Å—Ç –∑–∞–Ω–æ–≤–æ: 
/start")
        return

    user_state = user_data[chat_id]
    current_question = user_state['current_question']

    parts = call.data.split('_')
    question_index = int(parts[1])
    answer_index = int(parts[2])

    if question_index == current_question:
        question_data = questions[question_index]
        is_correct = (answer_index == question_data['correct_answer'])

        if is_correct:
            user_state['score'] += 1

        user_state['answers'].append({
            'question_index': question_index,
            'answer_index': answer_index,
            'is_correct': is_correct
        })

        user_state['current_question'] += 1

        if is_correct:
            bot.answer_callback_query(call.id, "‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!")
        else:
            correct_answer = 
question_data['options'][question_data['correct_answer']]
            bot.answer_callback_query(call.id, f"‚ùå –ü—Ä–∞–≤–∏–ª—å–Ω–æ: 
{correct_answer}")

        send_question(chat_id)

def show_results(chat_id):
    user_state = user_data[chat_id]
    score = user_state['score']
    total_questions = len(questions)

    if score == total_questions:
        level = "üéâ –û–¢–õ–ò–ß–ù–û!"
        message = "–¢—ã –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ –æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ—à—å—Å—è –≤ –±—ã—Ç–æ–≤–æ–π –ª–µ–∫—Å–∏–∫–µ!"
        emoji = "üåü"
    elif score >= total_questions * 0.8:
        level = "üí™ –û–ß–ï–ù–¨ –•–û–†–û–®–û!"
        message = "–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –ü–æ—á—Ç–∏ –∏–¥–µ–∞–ª—å–Ω–æ!"
        emoji = "‚ú®"
    elif score >= total_questions * 0.6:
        level = "üìä –•–û–†–û–®–û!"
        message = "–°–æ–ª–∏–¥–Ω—ã–π –∑–∞–ø–∞—Å —Å–ª–æ–≤, –Ω–æ –µ—Å—Ç—å –∫—É–¥–∞ —Ä–∞—Å—Ç–∏!"
        emoji = "üìö"
    elif score >= total_questions * 0.4:
        level = "üéØ –ù–ï–ü–õ–û–•–û!"
        message = "–ë–∞–∑–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å –µ—Å—Ç—å, –Ω–æ –Ω—É–∂–Ω–æ –ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å—Å—è!"
        emoji = "üí™"
    else:
        level = "üå± –ù–ê–ß–ê–õ–¨–ù–´–ô!"
        message = "–ï—Å—Ç—å –Ω–∞–¥ —á–µ–º –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å! –ù–∞—á–Ω–∏ —Å –æ—Å–Ω–æ–≤!"
        emoji = "üîÑ"

    result_text = f"""
{emoji} *–¢–ï–°–¢ –ó–ê–í–ï–†–®–Å–ù!*

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìä *–¢–í–û–ô –†–ï–ó–£–õ–¨–¢–ê–¢:*
{level}
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

‚úÖ *–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤:* {score}/{total_questions}
{message}
    """

    bot.send_message(chat_id, result_text, parse_mode='Markdown')

    # –°—Ä–∞–∑—É –ø—Ä–µ–¥–ª–∞–≥–∞–µ–º –º–∏–Ω–∏-—É—Ä–æ–∫ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–∞
    lesson_text = """
üéÅ *–ë–û–ù–£–° –î–õ–Ø –¢–ï–ë–Ø!*

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üöÄ *–ë–ï–°–ü–õ–ê–¢–ù–´–ô –ú–ò–ù–ò-–£–†–û–ö*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

*–ü—Ä–æ–∫–∞—á–∞–π —Å–≤–æ–π –∞–Ω–≥–ª–∏–π—Å–∫–∏–π –¥–ª—è –∫—É–ª–∏–Ω–∞—Ä–∏–∏ –∏ –Ω–µ —Ç–æ–ª—å–∫–æ!*

üëá *–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –º–∏–Ω–∏-—É—Ä–æ–∫:*
    """

    markup = types.InlineKeyboardMarkup()
    mini_lesson_button = types.InlineKeyboardButton(
        'üçΩ –ü–û–õ–£–ß–ò–¢–¨ –ú–ò–ù–ò-–£–†–û–ö',
        callback_data='get_mini_lesson'
    )
    markup.add(mini_lesson_button)

    bot.send_message(chat_id, lesson_text, reply_markup=markup, 
parse_mode='Markdown')

@bot.callback_query_handler(func=lambda call: call.data == 
'get_mini_lesson')
def send_mini_lesson(call):
    chat_id = call.message.chat.id

    # –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤
    vocabulary_text = """
üìö *–ú–ò–ù–ò-–£–†–û–ö: –ö–£–õ–ò–ù–ê–†–ù–ê–Ø –õ–ï–ö–°–ò–ö–ê*

üçΩ *–í–∫—É—Å—ã –∏ —Ç–µ–∫—Å—Ç—É—Ä–∞:*
‚ñ™Ô∏è zesty ‚Äî —Å —è—Ä–∫–∏–º –≤–∫—É—Å–æ–º (—Ü–∏—Ç—Ä—É—Å–æ–≤—ã–π, –ø–∏–∫–∞–Ω—Ç–Ω—ã–π)
‚ñ™Ô∏è tangy ‚Äî —Å –ª—ë–≥–∫–æ–π –∫–∏—Å–ª–∏–Ω–∫–æ–π
‚ñ™Ô∏è crunchy on the outside, soft inside ‚Äî —Ö—Ä—É—Å—Ç—è—â–∏–π —Å–Ω–∞—Ä—É–∂–∏, –º—è–≥–∫–∏–π –≤–Ω—É—Ç—Ä–∏
‚ñ™Ô∏è melt-in-your-mouth ‚Äî —Ç–∞—é—â–∏–π –≤–æ —Ä—Ç—É
‚ñ™Ô∏è robust ‚Äî –Ω–∞—Å—ã—â–µ–Ω–Ω—ã–π, –±–æ–≥–∞—Ç—ã–π –≤–∫—É—Å
‚ñ™Ô∏è pungent ‚Äî —Ä–µ–∑–∫–∏–π, –æ—Å—Ç—Ä—ã–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Å–Ω–æ–∫)
‚ñ™Ô∏è fluffy ‚Äî –ø—ã—à–Ω—ã–π, –≤–æ–∑–¥—É—à–Ω—ã–π
‚ñ™Ô∏è creamy ‚Äî —Å–ª–∏–≤–æ—á–Ω—ã–π, –∫—Ä–µ–º–æ–≤—ã–π
‚ñ™Ô∏è bland ‚Äî –±–µ–∑–≤–∫—É—Å–Ω—ã–π, –ø—Ä–µ—Å–Ω—ã–π
‚ñ™Ô∏è smooth ‚Äî –≥–ª–∞–¥–∫–∏–π, –æ–¥–Ω–æ—Ä–æ–¥–Ω—ã–π
‚ñ™Ô∏è sour ‚Äî –∫–∏—Å–ª—ã–π

üî™ *–ì–ª–∞–≥–æ–ª—ã (–¥–µ–π—Å—Ç–≤–∏—è):*
‚ñ™Ô∏è drizzle ‚Äî —Å–±—Ä—ã–∑–Ω—É—Ç—å, –ø–æ–ª–∏—Ç—å —Å–≤–µ—Ä—Ö—É
‚ñ™Ô∏è fold in ‚Äî –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –≤–º–µ—à–∞—Ç—å
‚ñ™Ô∏è sear ‚Äî –æ–±–∂–∞—Ä–∏—Ç—å –¥–æ –∫–æ—Ä–æ—á–∫–∏
‚ñ™Ô∏è marinate ‚Äî –º–∞—Ä–∏–Ω–æ–≤–∞—Ç—å
‚ñ™Ô∏è zest ‚Äî –Ω–∞—Ç–µ—Ä–µ—Ç—å —Ü–µ–¥—Ä—É
‚ñ™Ô∏è whip up ‚Äî –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –Ω–∞ —Å–∫–æ—Ä—É—é —Ä—É–∫—É
‚ñ™Ô∏è whisk up - –≤–∑–±–∏—Ç—å
‚ñ™Ô∏è toss ‚Äî –ø–µ—Ä–µ–º–µ—à–∞—Ç—å (—Å–∞–ª–∞—Ç)
‚ñ™Ô∏è peel ‚Äî –ø–æ—á–∏—Å—Ç–∏—Ç—å
‚ñ™Ô∏è chop nuts ‚Äî –ø–æ—Ä–µ–∑–∞—Ç—å / –ø–æ–∫—Ä–æ—à–∏—Ç—å
‚ñ™Ô∏è cool off ‚Äî –æ—Å—Ç—ã—Ç—å, –æ—Å—Ç—É–¥–∏—Ç—å
‚ñ™Ô∏è plate everything ‚Äî –≤—ã–ª–æ–∂–∏—Ç—å –≤—Å—ë –Ω–∞ —Ç–∞—Ä–µ–ª–∫—É

ü•£ *–°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è:*
‚ñ™Ô∏è cutting board ‚Äî —Ä–∞–∑–¥–µ–ª–æ—á–Ω–∞—è –¥–æ—Å–∫–∞
‚ñ™Ô∏è leftovers ‚Äî –æ—Å—Ç–∞—Ç–∫–∏ –µ–¥—ã
‚ñ™Ô∏è clove (garlic) ‚Äî –∑—É–±—á–∏–∫ —á–µ—Å–Ω–æ–∫–∞
‚ñ™Ô∏è grater ‚Äî —Ç—ë—Ä–∫–∞
‚ñ™Ô∏è skewer ‚Äî —à–ø–∞–∂–∫–∞
‚ñ™Ô∏è meal prepping ‚Äî –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –µ–¥—ã –∑–∞—Ä–∞–Ω–µ–µ
‚ñ™Ô∏è heaping amount of ‚Äî —Å –≥–æ—Ä–∫–æ–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–∂–∫–∞ —Å –≥–æ—Ä–∫–æ–π)
    """

    bot.send_message(chat_id, vocabulary_text, parse_mode='Markdown')

    # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º
    exercises_text = """
üéØ *–û—Ç–ª–∏—á–Ω–æ! –¢–µ–ø–µ—Ä—å –∑–∞–∫—Ä–µ–ø–∏–º –∑–Ω–∞–Ω–∏—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ*

üëá *–ü–µ—Ä–µ—Ö–æ–¥–∏ –∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è–º:*
    """

    markup = types.InlineKeyboardMarkup()
    exercises_button = types.InlineKeyboardButton(
        'üìù –ü–ï–†–ï–ô–¢–ò –ö –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø–ú',
        callback_data='get_exercises'
    )
    markup.add(exercises_button)

    bot.send_message(chat_id, exercises_text, reply_markup=markup, 
parse_mode='Markdown')

@bot.callback_query_handler(func=lambda call: call.data == 
'get_exercises')
def send_exercises(call):
    chat_id = call.message.chat.id

    exercises_text = """
üéØ *–ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –£–ü–†–ê–ñ–ù–ï–ù–ò–Ø:*

‚Ä¢ [üç≥ Cooking Vocabulary 
Flashcards](https://fliktop.ru/christina.sedova/playlist/cards/net-nazvaniya/ffe8b6f4-03d9-4d11-a125-770b66d9bea0/?open=true)
‚Ä¢ [‚úÖ Choose the Correct 
Option](https://fliktop.ru/christina.sedova/playlist/cards/choose-the-correct-option/95dae03b-ca13-4d58-bd9d-48b14b436ed4/?open=true)
    """

    bot.send_message(chat_id, exercises_text, parse_mode='Markdown')

    # –ö–Ω–æ–ø–∫–∞ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
    materials_text = """
üìö *–•–æ—á–µ—à—å —É–≥–ª—É–±–∏—Ç—å –∑–Ω–∞–Ω–∏—è?*

–ò–∑—É—á–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –ø–æ —Ç–µ–º–µ:
    """

    markup = types.InlineKeyboardMarkup()
    materials_button = types.InlineKeyboardButton(
        'üîç –ü–û–õ–£–ß–ò–¢–¨ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–ê–¢–ï–†–ò–ê–õ–´',
        callback_data='get_materials'
    )
    markup.add(materials_button)

    bot.send_message(chat_id, materials_text, reply_markup=markup, 
parse_mode='Markdown')

@bot.callback_query_handler(func=lambda call: call.data == 
'get_materials')
def send_materials(call):
    chat_id = call.message.chat.id

    materials_text = """
üîç *–î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –ú–ê–¢–ï–†–ò–ê–õ–´:*

üé• *YouTube:*
‚Ä¢ [Korean Beef Bulgogi 
Recipe](https://youtu.be/mhDJNfV7hjk?si=4Ui4A0Ka7_888Rtd)
‚Ä¢ [Easy Cooking Techniques](https://www.youtube.com/watch?v=LYzRXCzxDeY)
‚Ä¢ [Kitchen Vocabulary](https://www.youtube.com/watch?v=HR61Hwt2qUA)
‚Ä¢ [Food Preparation Tips](https://www.youtube.com/watch?v=ZJy1ajvMU1k)
‚Ä¢ [Quick Meal Ideas](https://www.youtube.com/watch?v=OTAwvdRJn6M)

üìñ *–°—Ç–∞—Ç—å–∏:*
‚Ä¢ [Korean Beef Bulgogi 
Recipe](https://www.recipetineats.com/korean-beef-bulgogi-rice-bowls-the-easy-way/)
‚Ä¢ [Creamy Greek Salad 
Dressing](https://lisagcooks.com/creamy-greek-salad-dressing/)
    """

    bot.send_message(chat_id, materials_text, parse_mode='Markdown')

    # –ö–Ω–æ–ø–∫–∞ "–•–æ—á—É –±–æ–ª—å—à–µ —É—Ä–æ–∫–æ–≤" –ø–æ—Å–ª–µ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
    more_lessons_text = """
‚ú® *–ü–æ–Ω—Ä–∞–≤–∏–ª—Å—è —É—Ä–æ–∫?*

–•–æ—á–µ—à—å –ø–æ–ª—É—á–∞—Ç—å —Ç–∞–∫–∏–µ —É—Ä–æ–∫–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø–æ —Ä–∞–∑–Ω—ã–º —Ç–µ–º–∞–º?
    """

    markup = types.InlineKeyboardMarkup()
    more_lessons_button = types.InlineKeyboardButton(
        'üöÄ –•–û–ß–£ –ë–û–õ–¨–®–ï –£–†–û–ö–û–í',
        callback_data='want_more_lessons'
    )
    markup.add(more_lessons_button)

    bot.send_message(chat_id, more_lessons_text, reply_markup=markup, 
parse_mode='Markdown')

@bot.callback_query_handler(func=lambda call: call.data == 
'want_more_lessons')
def offer_premium_content(call):
    chat_id = call.message.chat.id

    premium_text = """
üéä *–•–û–ß–ï–®–¨ –ï–©–Å –ë–û–õ–¨–®–ï –ü–û–õ–ï–ó–ù–û–ô –õ–ï–ö–°–ò–ö–ò?*

–í —ç—Ç–æ–º –º–∏–Ω–∏-—É—Ä–æ–∫–µ —Ç—ã —É–≤–∏–¥–µ–ª —Ç–æ–ª—å–∫–æ 30 —Å–ª–æ–≤ –ø–æ –∫—É–ª–∏–Ω–∞—Ä–∏–∏, –Ω–æ –Ω–∞ –º–æ—ë–º 
–∑–∞–∫—Ä—ã—Ç–æ–º –∫–∞–Ω–∞–ª–µ –±–æ–ª–µ–µ 70 —Å–ª–æ–≤ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–π –ø–æ –∫–∞–∂–¥–æ–π —Ç–µ–º–µ!

–Ø –ø—Ä–∏–≥–ª–∞—à–∞—é —Ç–µ–±—è –≤ –º–æ–π *–ó–ê–ö–†–´–¢–´–ô –¢–ï–õ–ï–ì–†–ê–ú–ú –ö–ê–ù–ê–õ!*

*–¢–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ —É–∂–µ –∂–¥—É—Ç —Ç–µ–±—è:*
‚òÄÔ∏è Summer vocabulary
üèñ Beach and vacation
üßπ Cleaning routines
üöΩ Toilet and bathroom
üßñüèª‚Äç‚ôÄÔ∏è Personal hygiene
ü©∏ Period and health
üíÖüèª Beauty and self-care
üìö Education and learning
üçΩ Kitchen tools and equipment

*–ß—Ç–æ —Ç—ã –ø–æ–ª—É—á–∞–µ—à—å:*
üéØ 70+ —Å–ª–æ–≤ –∏ –≤—ã—Ä–∞–∂–µ–Ω–∏–π –ø–æ –∫–∞–∂–¥–æ–π —Ç–µ–º–µ
üìù –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã
‚úÖ –¢–µ—Å—Ç—ã –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
üìö –ü–æ–¥–±–æ—Ä–∫–∞ –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
üîÑ *–ü–û–ñ–ò–ó–ù–ï–ù–ù–´–ô –î–û–°–¢–£–ü*

üí∏ *–í—Å–µ–≥–æ 690 —Ä—É–±–ª–µ–π*

üëá *–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –∫–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø:*
    """

    markup = types.InlineKeyboardMarkup()
    premium_button = types.InlineKeyboardButton(
        'üíé –ü–û–õ–£–ß–ò–¢–¨ –ü–û–õ–ù–´–ô –î–û–°–¢–£–ü',
        callback_data='get_premium_info'
    )
    markup.add(premium_button)

    bot.send_message(chat_id, premium_text, reply_markup=markup, 
parse_mode='Markdown')

@bot.callback_query_handler(func=lambda call: call.data == 
'get_premium_info')
def handle_premium_info(call):
    chat_id = call.message.chat.id

    premium_info = """
üí´ *–û–§–û–†–ú–õ–ï–ù–ò–ï –î–û–°–¢–£–ü–ê*

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ –∫ –ø—Ä–µ–º–∏—É–º –∫–∞–Ω–∞–ª—É:

1. *–ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –¥–ª—è –æ–ø–ª–∞—Ç—ã:*
   https://payform.ru/ah8YSST/

2. *–ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –æ–ø–ª–∞—Ç—ã:*
   - –£–∫–∞–∂–∏—Ç–µ –≤–∞—à–µ –∏–º—è –∏ email
   - –û–ø–ª–∞—Ç–∏—Ç–µ 690 —Ä—É–±–ª–µ–π

3. *–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–ø–ª–∞—Ç—ã:*
   - –°—Å—ã–ª–∫–∞ –Ω–∞ –∑–∞–∫—Ä—ã—Ç—ã–π –∫–∞–Ω–∞–ª –ø—Ä–∏–¥–µ—Ç –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –ø–æ—á—Ç—É
   - –ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã - –Ω–∞–ø–∏—à–∏—Ç–µ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É
    """

    markup = types.InlineKeyboardMarkup()
    pay_button = types.InlineKeyboardButton(
        'üí≥ –û–ü–õ–ê–¢–ò–¢–¨ 690‚ÇΩ',
        url='https://payform.ru/ah8YSST/'
    )
    support_button = types.InlineKeyboardButton(
        'üí¨ –ù–ê–ü–ò–°–ê–¢–¨ –í –ü–û–î–î–ï–†–ñ–ö–£',
        url='https://t.me/christie_cheers'
    )
    markup.add(pay_button)
    markup.add(support_button)

    bot.send_message(chat_id, premium_info, reply_markup=markup, 
parse_mode='Markdown')

@bot.callback_query_handler(func=lambda call: call.data == 'restart_test')
def restart_test(call):
    chat_id = call.message.chat.id
    user_data[chat_id] = {
        'current_question': 0,
        'score': 0,
        'answers': []
    }

    send_question(chat_id)

@bot.message_handler(func=lambda message: True)
def handle_other_messages(message):
    if message.text and message.text.startswith('/'):
        return

    markup = types.InlineKeyboardMarkup()
    start_button = types.InlineKeyboardButton('üöÄ –ù–ê–ß–ê–¢–¨ –¢–ï–°–¢', 
callback_data='start_test')
    markup.add(start_button)

    bot.send_message(
        message.chat.id,
        "üéì *–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Ç–µ—Å—Ç –ø–æ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º—É!*",
        reply_markup=markup,
        parse_mode='Markdown'
    )

def run_bot():
    print("–ë–æ—Ç –∑–∞–ø—É—â–µ–Ω...")
    keep_alive()
    
    while True:
        try:
            print("–ó–∞–ø—É—Å–∫–∞–µ–º polling...")
            bot.polling(none_stop=True, interval=1, timeout=30)
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞: {e}")
            print("–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥...")
            time.sleep(10)

if __name__ == "__main__":
    run_bot()

